(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[348],{7945:function(e,t,s){Promise.resolve().then(s.bind(s,3908))},3908:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return eP}});var a=s(7437),i=s(2265),l=s(521),n=s(2451),c=s(407),r=s(5901),o=s(1723),d=s(2208),x=s(8662),m=s(9374),u=s(3417),h=s(7806),g=s(8728),p=s(8124),b=s(3468),j=s(5805),f=s(7648),y=s(3448),v=s(2371),N=s(8614),w=s(8554),S=s(1473),k=s(1740),z=s(2023),C=s(3581),Z=s(3113),I=s(9202),A=s(5277),E=s(9397),T=s(1905),L=s(7769),D=s(6337),_=s(9711),P=s(8930);let U=[{id:"single",label:"Single",icon:(0,a.jsx)(r.Z,{size:16})},{id:"side-by-side",label:"Side by Side",icon:(0,a.jsx)(b.Z,{size:16})},{id:"pip",label:"Picture in Picture",icon:(0,a.jsx)(w.Z,{size:16})},{id:"grid",label:"Grid",icon:(0,a.jsx)(S.Z,{size:16})},{id:"custom",label:"Custom",icon:(0,a.jsx)(k.Z,{size:16})}],R=[{type:"avatar",label:"AI Avatar",icon:(0,a.jsx)(z.Z,{size:16})},{type:"camera",label:"Camera",icon:(0,a.jsx)(C.Z,{size:16})},{type:"screen",label:"Screen Share",icon:(0,a.jsx)(r.Z,{size:16})},{type:"image",label:"Image",icon:(0,a.jsx)(Z.Z,{size:16})},{type:"video",label:"Video",icon:(0,a.jsx)(m.Z,{size:16})},{type:"browser",label:"Browser",icon:(0,a.jsx)(I.Z,{size:16})},{type:"text",label:"Text",icon:(0,a.jsx)(A.Z,{size:16})}];function F(e){let{className:t}=e,{activeScene:s,scenes:n,setActiveScene:c,addScene:r,removeScene:o}=(0,v.D)(),[x,m]=(0,i.useState)(!1),[u,h]=(0,i.useState)(null),g=(0,i.useRef)(null),b=e=>{s&&c({...s,layout:e})},j=e=>{if(!s)return;let t={id:"source-".concat(Date.now()),type:e,name:"".concat(e.charAt(0).toUpperCase()+e.slice(1)," Source"),position:{x:50,y:50},size:{width:400,height:300},zIndex:s.sources.length,visible:!0,locked:!1,settings:{}};c({...s,sources:[...s.sources,t]}),m(!1)},f=e=>{s&&c({...s,sources:s.sources.map(t=>t.id===e?{...t,visible:!t.visible}:t)})},w=e=>{s&&c({...s,sources:s.sources.map(t=>t.id===e?{...t,locked:!t.locked}:t)})},S=e=>{s&&c({...s,sources:s.sources.filter(t=>t.id!==e)})},k=e=>{let t=R.find(t=>t.type===e);return(null==t?void 0:t.icon)||(0,a.jsx)(p.Z,{size:16})};return(0,a.jsxs)("div",{className:(0,y.cn)("glass rounded-2xl p-4",t),children:[(0,a.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,a.jsxs)("h3",{className:"font-semibold flex items-center gap-2",children:[(0,a.jsx)(p.Z,{size:18,className:"text-accent-gold"}),"Scene Layout"]})}),s?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block text-xs text-gray-400 mb-2",children:"Layout Type"}),(0,a.jsx)("div",{className:"grid grid-cols-5 gap-1",children:U.map(e=>(0,a.jsxs)("button",{onClick:()=>b(e.id),className:(0,y.cn)("p-2 rounded-lg flex flex-col items-center gap-1 transition-colors",s.layout===e.id?"bg-accent-gold/20 text-accent-gold border border-accent-gold/50":"bg-white/5 hover:bg-white/10 text-gray-400"),title:e.label,children:[e.icon,(0,a.jsx)("span",{className:"text-[10px]",children:e.label})]},e.id))})]}),(0,a.jsxs)("div",{ref:g,className:"relative aspect-video bg-surface-500 rounded-xl overflow-hidden mb-4 border border-white/10",children:[s.sources.map(e=>(0,a.jsx)(l.E.div,{className:(0,y.cn)("absolute rounded-lg border-2 flex items-center justify-center transition-all cursor-move",e.visible?"opacity-100":"opacity-30",e.locked?"border-gray-500":"border-accent-gold",u===e.id&&"ring-2 ring-accent-burgundy"),style:{left:"".concat(e.position.x,"%"),top:"".concat(e.position.y,"%"),width:"30%",height:"40%",transform:"translate(-50%, -50%)",zIndex:e.zIndex},onClick:()=>h(e.id),children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"w-8 h-8 mx-auto bg-white/10 rounded-lg flex items-center justify-center mb-1",children:k(e.type)}),(0,a.jsx)("span",{className:"text-[10px] text-gray-400",children:e.name})]})},e.id)),0===s.sources.length&&(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center text-gray-500",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(p.Z,{size:32,className:"mx-auto mb-2 opacity-50"}),(0,a.jsx)("p",{className:"text-sm",children:"No sources added"})]})})]}),(0,a.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("label",{className:"text-xs text-gray-400",children:"Sources"}),(0,a.jsx)("button",{onClick:()=>m(!x),className:"p-1 rounded-md bg-accent-gold/20 text-accent-gold hover:bg-accent-gold/30 transition-colors",title:"Add Source","aria-label":"Add Source",children:(0,a.jsx)(E.Z,{size:14})})]}),(0,a.jsx)(N.M,{children:x&&(0,a.jsx)(l.E.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"grid grid-cols-4 gap-1 p-2 bg-white/5 rounded-lg overflow-hidden",children:R.map(e=>(0,a.jsxs)("button",{onClick:()=>j(e.type),className:"p-2 rounded-lg bg-white/5 hover:bg-white/10 flex flex-col items-center gap-1 transition-colors",children:[e.icon,(0,a.jsx)("span",{className:"text-[10px] text-gray-400",children:e.label})]},e.type))})}),(0,a.jsx)("div",{className:"space-y-1 max-h-[150px] overflow-y-auto",children:s.sources.map((e,t)=>(0,a.jsxs)("div",{className:(0,y.cn)("flex items-center gap-2 p-2 rounded-lg transition-colors",u===e.id?"bg-accent-burgundy/20 border border-accent-burgundy/50":"bg-white/5 hover:bg-white/10"),onClick:()=>h(e.id),children:[(0,a.jsx)(T.Z,{size:14,className:"text-gray-500 cursor-grab"}),(0,a.jsx)("div",{className:"w-6 h-6 rounded bg-white/10 flex items-center justify-center",children:k(e.type)}),(0,a.jsx)("span",{className:"flex-1 text-sm truncate",children:e.name}),(0,a.jsx)("button",{onClick:t=>{t.stopPropagation(),f(e.id)},className:(0,y.cn)("p-1 rounded",e.visible?"text-gray-400":"text-red-400"),title:e.visible?"Hide":"Show",children:e.visible?(0,a.jsx)(d.Z,{size:12}):(0,a.jsx)(L.Z,{size:12})}),(0,a.jsx)("button",{onClick:t=>{t.stopPropagation(),w(e.id)},className:(0,y.cn)("p-1 rounded",e.locked?"text-yellow-400":"text-gray-400"),title:e.locked?"Unlock":"Lock",children:e.locked?(0,a.jsx)(D.Z,{size:12}):(0,a.jsx)(_.Z,{size:12})}),(0,a.jsx)("button",{onClick:t=>{t.stopPropagation(),S(e.id)},className:"p-1 rounded text-red-400 hover:bg-red-400/20",title:"Remove",children:(0,a.jsx)(P.Z,{size:12})})]},e.id))})]}),(0,a.jsxs)("div",{className:"border-t border-white/10 pt-4",children:[(0,a.jsx)("label",{className:"block text-xs text-gray-400 mb-2",children:"Scene Transition"}),(0,a.jsx)("div",{className:"grid grid-cols-4 gap-1",children:["cut","fade","slide","zoom"].map(e=>(0,a.jsx)("button",{onClick:()=>{s&&c({...s,transitionType:e})},className:(0,y.cn)("p-2 rounded-lg text-xs capitalize transition-colors",s.transitionType===e?"bg-accent-gold/20 text-accent-gold border border-accent-gold/50":"bg-white/5 hover:bg-white/10 text-gray-400"),children:e},e))})]})]}):(0,a.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,a.jsx)(p.Z,{size:32,className:"mx-auto mb-2 opacity-50"}),(0,a.jsx)("p",{className:"text-sm",children:"No scene selected"}),(0,a.jsx)("p",{className:"text-xs",children:"Select a scene to edit its layout"})]})]})}function B(e){let{className:t}=e,{scenes:s,activeScene:n,previewScene:c,setActiveScene:r,setPreviewScene:o,addScene:d}=(0,v.D)(),[x,m]=(0,i.useState)(!1),[u,h]=(0,i.useState)(""),g=()=>{u.trim()&&(d({id:"scene-".concat(Date.now()),name:u,sources:[],layout:"single",transitionType:"fade",transitionDuration:300}),h(""),m(!1))};return(0,a.jsxs)("div",{className:(0,y.cn)("glass rounded-2xl p-4",t),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsx)("h3",{className:"font-semibold text-sm",children:"Scenes"}),(0,a.jsx)("button",{onClick:()=>m(!x),className:"p-1 rounded-md bg-accent-gold/20 text-accent-gold hover:bg-accent-gold/30 transition-colors",title:"Add Scene","aria-label":"Add Scene",children:(0,a.jsx)(E.Z,{size:14})})]}),(0,a.jsx)(N.M,{children:x&&(0,a.jsx)(l.E.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mb-3 overflow-hidden",children:(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("input",{type:"text",value:u,onChange:e=>h(e.target.value),placeholder:"Scene name",className:"input-field flex-1 text-sm",onKeyDown:e=>"Enter"===e.key&&g()}),(0,a.jsx)("button",{onClick:g,disabled:!u.trim(),className:"px-3 py-2 rounded-lg bg-accent-gold text-white text-sm disabled:opacity-50",children:"Add"})]})})}),(0,a.jsx)("div",{className:"grid grid-cols-2 gap-2",children:s.map(e=>(0,a.jsxs)(l.E.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>r(e),onDoubleClick:()=>o(e),className:(0,y.cn)("p-3 rounded-xl text-left transition-all",(null==n?void 0:n.id)===e.id?"bg-accent-gold/20 border border-accent-gold/50 shadow-neon-gold":"bg-white/5 hover:bg-white/10 border border-transparent"),children:[(0,a.jsx)("div",{className:"aspect-video bg-surface-500 rounded-lg mb-2 flex items-center justify-center",children:(0,a.jsx)(p.Z,{size:20,className:"text-gray-500"})}),(0,a.jsx)("span",{className:"text-xs font-medium truncate block",children:e.name}),(0,a.jsxs)("span",{className:"text-[10px] text-gray-500",children:[e.sources.length," sources"]})]},e.id))})]})}var M=s(4767),O=s(5349),V=s(9219),H=s(3276),G=s(9227),X=s(1706),J=s(8623),W=s(7414),K=s(3247),q=s(6595),Q=s(5468),Y=s(257);function $(e){let{streamId:t,className:s}=e,{chatMessages:n,chatPaused:c,toggleChatPause:r,addChatMessage:o,clearChat:d}=(0,v.D)(),[x,m]=(0,i.useState)("all"),[h,p]=(0,i.useState)(""),[b,j]=(0,i.useState)(!1),[f,w]=(0,i.useState)(!1),[S,k]=(0,i.useState)(!0),C=(0,i.useRef)(null);(0,i.useEffect)(()=>{!c&&C.current&&(C.current.scrollTop=C.current.scrollHeight)},[n,c]);let Z=e=>{switch(e.toLowerCase()){case"youtube":return(0,a.jsx)(M.Z,{size:12,className:"text-red-500"});case"twitch":return(0,a.jsx)(O.Z,{size:12,className:"text-purple-500"});case"facebook":return(0,a.jsx)(V.Z,{size:12,className:"text-blue-500"});default:return(0,a.jsx)(u.Z,{size:12,className:"text-gray-400"})}},I=n.filter(e=>!!(("all"===x||e.platform.toLowerCase()===x)&&(!h||e.message.toLowerCase().includes(h.toLowerCase())||e.username.toLowerCase().includes(h.toLowerCase())))),A=e=>{console.log("Highlight message:",e)},E=e=>{console.log("Ban user:",e)},T=async e=>{try{let t=await fetch("".concat(Y.env.NEXT_PUBLIC_API_URL,"/api/ai/chat-response"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:e.message,streamTopic:"general",previousResponses:[]})}),s=await t.json();s.response&&o({id:"ai-".concat(Date.now()),platform:"ai",username:"AI Assistant",message:s.response,timestamp:new Date,highlighted:!0,badges:["ai"]})}catch(e){console.error("Failed to generate AI response:",e)}};return(0,a.jsxs)("div",{className:(0,y.cn)("glass rounded-2xl flex flex-col h-full",s),children:[(0,a.jsxs)("div",{className:"p-4 border-b border-white/10",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsxs)("h3",{className:"font-semibold flex items-center gap-2",children:[(0,a.jsx)(u.Z,{size:18,className:"text-accent-gold"}),"Live Chat",(0,a.jsx)("span",{className:"text-xs bg-accent-gold/20 text-accent-gold px-2 py-0.5 rounded-full",children:n.length})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("button",{onClick:r,className:(0,y.cn)("p-1.5 rounded-lg transition-colors",c?"bg-yellow-500/20 text-yellow-400":"bg-white/5 text-gray-400 hover:bg-white/10"),title:c?"Resume":"Pause",children:c?(0,a.jsx)(H.Z,{size:14}):(0,a.jsx)(G.Z,{size:14})}),(0,a.jsx)("button",{onClick:()=>j(!b),className:(0,y.cn)("p-1.5 rounded-lg transition-colors",b?"bg-accent-gold/20 text-accent-gold":"bg-white/5 text-gray-400 hover:bg-white/10"),title:"Settings",children:(0,a.jsx)(g.Z,{size:14})}),(0,a.jsx)("button",{onClick:d,className:"p-1.5 rounded-lg bg-white/5 text-gray-400 hover:bg-red-500/20 hover:text-red-400 transition-colors",title:"Clear Chat",children:(0,a.jsx)(P.Z,{size:14})})]})]}),(0,a.jsx)(N.M,{children:b&&(0,a.jsxs)(l.E.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"space-y-2 mb-3 overflow-hidden",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-2 rounded-lg bg-white/5",children:[(0,a.jsxs)("span",{className:"text-xs text-gray-400 flex items-center gap-2",children:[f?(0,a.jsx)(X.Z,{size:14}):(0,a.jsx)(J.Z,{size:14}),"Text-to-Speech"]}),(0,a.jsx)("button",{onClick:()=>w(!f),className:(0,y.cn)("w-10 h-5 rounded-full transition-colors relative",f?"bg-accent-gold":"bg-gray-600"),title:f?"Disable TTS":"Enable TTS","aria-label":f?"Disable TTS":"Enable TTS",children:(0,a.jsx)("div",{className:(0,y.cn)("absolute top-0.5 w-4 h-4 rounded-full bg-white transition-all",f?"left-5":"left-0.5")})})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between p-2 rounded-lg bg-white/5",children:[(0,a.jsxs)("span",{className:"text-xs text-gray-400 flex items-center gap-2",children:[(0,a.jsx)(W.Z,{size:14}),"Highlight Donations"]}),(0,a.jsx)("button",{onClick:()=>k(!S),className:(0,y.cn)("w-10 h-5 rounded-full transition-colors relative",S?"bg-accent-gold":"bg-gray-600"),title:S?"Hide Donation Highlights":"Show Donation Highlights","aria-label":S?"Hide Donation Highlights":"Show Donation Highlights",children:(0,a.jsx)("div",{className:(0,y.cn)("absolute top-0.5 w-4 h-4 rounded-full bg-white transition-all",S?"left-5":"left-0.5")})})]})]})}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)("div",{className:"relative flex-1",children:[(0,a.jsx)(K.Z,{size:14,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),(0,a.jsx)("input",{type:"text",value:h,onChange:e=>p(e.target.value),placeholder:"Search messages...",className:"input-field pl-9 text-xs py-2"})]}),(0,a.jsxs)("select",{value:x,onChange:e=>m(e.target.value),className:"input-field text-xs py-2 w-24",title:"Filter by platform",children:[(0,a.jsx)("option",{value:"all",children:"All"}),(0,a.jsx)("option",{value:"youtube",children:"YouTube"}),(0,a.jsx)("option",{value:"twitch",children:"Twitch"}),(0,a.jsx)("option",{value:"facebook",children:"Facebook"})]})]})]}),(0,a.jsx)("div",{ref:C,className:"flex-1 overflow-y-auto p-3 space-y-2",children:0===I.length?(0,a.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,a.jsx)(u.Z,{size:32,className:"mx-auto mb-2 opacity-50"}),(0,a.jsx)("p",{className:"text-sm",children:"No messages yet"})]}):(0,a.jsx)(N.M,{initial:!1,children:I.map(e=>{var t;return(0,a.jsx)(l.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,x:-10},className:(0,y.cn)("group p-2.5 rounded-xl transition-colors",e.highlighted?"bg-accent-gold/10 border border-accent-gold/30":e.donation&&S?"bg-accent-burgundy/10 border border-accent-burgundy/30":"bg-white/5 hover:bg-white/8"),children:(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[(0,a.jsx)("div",{className:"w-7 h-7 rounded-full bg-gradient-to-br from-accent-burgundy to-accent-gold flex items-center justify-center flex-shrink-0",children:e.userAvatar?(0,a.jsx)("img",{src:e.userAvatar,alt:"",className:"w-full h-full rounded-full object-cover"}):(0,a.jsx)("span",{className:"text-xs font-bold text-white",children:e.username.charAt(0).toUpperCase()})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1.5 mb-0.5",children:[Z(e.platform),(0,a.jsx)("span",{className:(0,y.cn)("text-xs font-semibold truncate","AI_DIRECTOR"===e.username?"text-accent-gold":"text-white"),children:"AI_DIRECTOR"===e.username?"Director":e.username}),"AI_DIRECTOR"===e.username&&(0,a.jsx)("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-accent-gold/20 text-accent-gold border border-accent-gold/30",children:"SYSTEM"}),null===(t=e.badges)||void 0===t?void 0:t.map(e=>(0,a.jsx)("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-accent-burgundy/20 text-accent-gold",children:e},e)),e.donation&&(0,a.jsxs)("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-accent-gold/20 text-accent-gold flex items-center gap-0.5",children:[(0,a.jsx)(W.Z,{size:10}),e.donation.currency,e.donation.amount]})]}),(0,a.jsx)("p",{className:"text-sm text-gray-200 break-words",children:e.message}),(0,a.jsx)("span",{className:"text-[10px] text-gray-500 mt-1 block",children:(0,y.BK)(e.timestamp)})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[(0,a.jsx)("button",{onClick:()=>A(e.id),className:"p-1 rounded text-gray-400 hover:text-yellow-400 hover:bg-yellow-400/20",title:"Highlight",children:(0,a.jsx)(q.Z,{size:12})}),(0,a.jsx)("button",{onClick:()=>T(e),className:"p-1 rounded text-gray-400 hover:text-accent-gold hover:bg-accent-gold/20",title:"AI Response",children:(0,a.jsx)(z.Z,{size:12})}),(0,a.jsx)("button",{onClick:()=>E(e.username),className:"p-1 rounded text-gray-400 hover:text-red-400 hover:bg-red-400/20",title:"Ban User",children:(0,a.jsx)(Q.Z,{size:12})})]})]})},e.id)})})}),c&&(0,a.jsx)("div",{className:"px-4 py-2 bg-yellow-500/20 border-t border-yellow-500/30 text-center",children:(0,a.jsxs)("span",{className:"text-xs text-yellow-400 flex items-center justify-center gap-1",children:[(0,a.jsx)(G.Z,{size:12}),"Chat paused - Scroll to see new messages"]})})]})}var ee=s(4989);function et(e){let{className:t}=e,{stream:s,isStreaming:i,streamDuration:p,toggleSidebar:b,sidebarOpen:j}=(0,v.D)();return(0,a.jsxs)("header",{className:(0,y.cn)("h-16 glass border-b border-white/10 flex items-center justify-between px-6",t),children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("button",{onClick:b,className:"p-2 rounded-lg hover:bg-white/10 transition-colors",children:j?(0,a.jsx)(n.Z,{size:20}):(0,a.jsx)(c.Z,{size:20})}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-accent-burgundy to-accent-gold flex items-center justify-center",children:(0,a.jsx)(r.Z,{size:20})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"font-bold text-lg leading-tight",children:(null==s?void 0:s.title)||"AI Avatar Studio"}),(0,a.jsx)("p",{className:"text-xs text-gray-400",children:i?"Broadcasting Live":"Offline"})]})]})]}),(0,a.jsx)("div",{className:"flex items-center gap-6",children:i&&(0,a.jsxs)(l.E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"live-indicator px-4 py-2 rounded-full bg-red-500/20 text-red-400 font-semibold text-sm",children:"LIVE"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-gray-300",children:[(0,a.jsx)(o.Z,{size:16}),(0,a.jsx)("span",{className:"font-mono",children:(0,y.LU)(p)})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-gray-300",children:[(0,a.jsx)(d.Z,{size:16}),(0,a.jsx)("span",{children:(0,y.uf)((null==s?void 0:s.viewerCount)||0)})]})]})}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(es,{icon:(0,a.jsx)(x.Z,{size:18}),active:!0}),(0,a.jsx)(es,{icon:(0,a.jsx)(m.Z,{size:18}),active:!0}),(0,a.jsx)(es,{icon:(0,a.jsx)(u.Z,{size:18})}),(0,a.jsx)(es,{icon:(0,a.jsx)(h.Z,{size:18})}),(0,a.jsx)("div",{className:"w-px h-8 bg-white/10 mx-2"}),(0,a.jsx)(f.default,{href:"/settings",className:"p-2.5 rounded-xl hover:bg-white/10 transition-colors",title:"Global Settings","aria-label":"Global Settings",children:(0,a.jsx)(g.Z,{size:20,className:"text-gray-400"})}),(0,a.jsx)(f.default,{href:"/profile",className:"ml-2 w-10 h-10 rounded-full bg-surface-300 border border-white/10 flex items-center justify-center overflow-hidden hover:border-accent-gold transition-all",title:"User Profile","aria-label":"User Profile",children:(0,a.jsx)("img",{src:"https://i.pravatar.cc/150?u=studio",alt:"Profile",className:"w-full h-full object-cover"})})]})]})}function es(e){let{icon:t,active:s=!1}=e;return(0,a.jsx)("button",{className:(0,y.cn)("p-2.5 rounded-xl transition-all duration-200",s?"bg-accent-gold/20 text-accent-gold":"bg-white/5 text-gray-400 hover:bg-white/10 hover:text-white"),children:t})}function ea(e){let{className:t}=e,{sidebarOpen:s,activePanel:i,setActivePanel:n,scenes:c,activeScene:r,chatMessages:o,guests:d,stream:x}=(0,v.D)();if(!s)return null;let m=[{id:"scenes",icon:(0,a.jsx)(p.Z,{size:20}),label:"Scenes",count:c.length},{id:"layout",icon:(0,a.jsx)(b.Z,{size:20}),label:"Layout",count:(null==r?void 0:r.sources.length)||0},{id:"chat",icon:(0,a.jsx)(u.Z,{size:20}),label:"Chat",count:o.length},{id:"guests",icon:(0,a.jsx)(j.Z,{size:20}),label:"Guests",count:d.length},{id:"settings",icon:(0,a.jsx)(g.Z,{size:20}),label:"Settings"}],h=(null==x?void 0:x.id)||"";return(0,a.jsxs)(l.E.aside,{initial:{width:0,opacity:0},animate:{width:320,opacity:1},exit:{width:0,opacity:0},className:(0,y.cn)("h-full glass-dark border-r border-white/10 flex flex-col",t),children:[(0,a.jsx)("div",{className:"flex border-b border-white/10",children:m.map(e=>(0,a.jsxs)("button",{onClick:()=>n(e.id),className:(0,y.cn)("flex-1 py-3 px-2 flex flex-col items-center gap-1 transition-all duration-200 relative",i===e.id?"text-accent-gold":"text-gray-400 hover:text-white"),title:e.label,children:[e.icon,(0,a.jsx)("span",{className:"text-[10px] font-medium",children:e.label}),void 0!==e.count&&e.count>0&&(0,a.jsx)("span",{className:"absolute top-1 right-1 w-4 h-4 rounded-full bg-accent-burgundy text-[10px] flex items-center justify-center text-white",children:e.count>99?"99+":e.count}),i===e.id&&(0,a.jsx)(l.E.div,{layoutId:"activeTab",className:"absolute bottom-0 left-0 right-0 h-0.5 bg-accent-gold"})]},e.id))}),(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 custom-scrollbar",children:["scenes"===i&&(0,a.jsx)(B,{}),"layout"===i&&(0,a.jsx)(F,{}),"chat"===i&&(0,a.jsx)($,{streamId:h}),"guests"===i&&(0,a.jsx)(ee.F5,{streamId:h}),"settings"===i&&(0,a.jsx)(ei,{})]})]})}function ei(){return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("h3",{className:"font-semibold text-lg flex items-center gap-2",children:[(0,a.jsx)(g.Z,{size:20,className:"text-accent-gold"}),"Stream Settings"]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm text-gray-400 mb-1.5 font-medium",children:"Stream Title"}),(0,a.jsx)("input",{type:"text",className:"input-field",placeholder:"Enter stream title...",defaultValue:"AI Avatar Livestream Studio"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm text-gray-400 mb-1.5 font-medium",children:"Description"}),(0,a.jsx)("textarea",{className:"input-field min-h-[100px] resize-none",placeholder:"Enter description..."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm text-gray-400 mb-1.5 font-medium",children:"Stream Quality"}),(0,a.jsxs)("select",{className:"input-field",title:"Stream Quality",children:[(0,a.jsx)("option",{children:"1080p 60fps (Recommended)"}),(0,a.jsx)("option",{children:"1080p 30fps"}),(0,a.jsx)("option",{children:"720p 60fps"}),(0,a.jsx)("option",{children:"720p 30fps"}),(0,a.jsx)("option",{children:"480p 30fps (Low Latency)"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm text-gray-400 mb-1.5 font-medium",children:"Latency Mode"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsx)("button",{className:"px-3 py-2 rounded-lg bg-accent-gold/20 border border-accent-gold/50 text-accent-gold text-xs font-semibold",children:"Ultra Low"}),(0,a.jsx)("button",{className:"px-3 py-2 rounded-lg bg-white/5 text-gray-400 text-xs font-semibold hover:bg-white/10 transition-colors",children:"Standard"})]})]}),(0,a.jsx)("div",{className:"pt-4 border-t border-white/10",children:(0,a.jsx)("button",{className:"w-full py-3 rounded-xl bg-accent-burgundy text-white font-bold hover:bg-accent-burgundy/80 transition-all shadow-neon-burgundy",children:"Save Changes"})})]})]})}var el=s(5287),en=s(7416),ec=s(1094),er=s(1171);let eo={fade:{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3}},slide:{initial:{x:"100%"},animate:{x:0},exit:{x:"-100%"},transition:{type:"spring",damping:20,stiffness:100}},zoom:{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:1.2,opacity:0},transition:{duration:.4}},cut:{initial:{opacity:1},animate:{opacity:1},exit:{opacity:1},transition:{duration:0}}};function ed(e){let{className:t}=e,{activeScene:s,isStreaming:n,streamDuration:c,updateStreamDuration:r,activeAvatar:o,stream:d}=(0,v.D)(),[x,m]=(0,i.useState)(!1),[u,h]=(0,i.useState)(!1);(0,i.useEffect)(()=>{let e;return n&&(e=setInterval(()=>{r(c+1)},1e3)),()=>clearInterval(e)},[n,c,r]);let p=eo[(null==s?void 0:s.transitionType)||"fade"]||eo.fade;return(0,a.jsx)("div",{className:(0,y.cn)("relative rounded-2xl overflow-hidden",t),children:(0,a.jsxs)("div",{className:"aspect-video bg-surface-400 relative",children:[(0,a.jsx)("div",{className:"absolute inset-0",children:(0,a.jsx)(N.M,{mode:"wait",children:s?(0,a.jsx)(l.E.div,{...p,className:"w-full h-full bg-surface-500 flex items-center justify-center overflow-hidden",children:o?(0,a.jsx)(er.F,{avatarId:o.id,streamId:(null==d?void 0:d.id)||"demo-stream",className:"w-full h-full"}):(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"w-32 h-32 mx-auto mb-4 rounded-full bg-gradient-to-br from-accent-burgundy/30 to-accent-gold/30 flex items-center justify-center backdrop-blur-xl",children:(0,a.jsx)(z.Z,{size:48,className:"text-accent-gold"})}),(0,a.jsx)("h3",{className:"text-xl font-semibold mb-1",children:s.name}),(0,a.jsxs)("p",{className:"text-gray-400 text-sm",children:[s.sources.length," sources configured"]})]})},s.id):(0,a.jsxs)(l.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"flex flex-col items-center justify-center h-full text-gray-500",children:[(0,a.jsx)(el.Z,{size:48,className:"mx-auto mb-4 opacity-50"}),(0,a.jsx)("p",{className:"text-lg",children:"No scene selected"}),(0,a.jsx)("p",{className:"text-sm",children:"Select a scene to preview"})]},"no-scene")})}),(0,a.jsx)(N.M,{children:n&&(0,a.jsxs)(l.E.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"absolute top-4 left-4 flex items-center gap-3",children:[(0,a.jsx)("div",{className:"live-indicator px-3 py-1.5 rounded-lg bg-red-500/90 text-white font-bold text-sm backdrop-blur-sm",children:"LIVE"}),(0,a.jsx)("div",{className:"px-3 py-1.5 rounded-lg bg-black/50 text-white font-mono text-sm backdrop-blur-sm",children:(0,y.LU)(c)})]})}),(0,a.jsx)("div",{className:"absolute bottom-0 left-0 right-0 p-4 bg-gradient-to-t from-black/80 to-transparent",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsx)("button",{onClick:()=>h(!u),className:"p-2 rounded-lg bg-black/40 hover:bg-black/60 transition-colors",children:u?(0,a.jsx)(J.Z,{size:18}):(0,a.jsx)(X.Z,{size:18})})}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{onClick:()=>m(!x),className:"p-2 rounded-lg bg-black/40 hover:bg-black/60 transition-colors",title:"Toggle Fullscreen","aria-label":"Toggle Fullscreen",children:(0,a.jsx)(en.Z,{size:18})}),(0,a.jsx)("button",{className:"p-2 rounded-lg bg-black/40 hover:bg-black/60 transition-colors",title:"Settings","aria-label":"Settings",children:(0,a.jsx)(g.Z,{size:18})})]})]})})]})})}function ex(e){let{className:t}=e,{isStreaming:s,startStream:n,stopStream:c,stream:r}=(0,v.D)(),[o,d]=(0,i.useState)(!1),x=async()=>{s?c():(d(!0),await new Promise(e=>setTimeout(e,1500)),n(),d(!1))};return(0,a.jsxs)("div",{className:(0,y.cn)("flex items-center justify-center gap-4 py-4",t),children:[(0,a.jsxs)(l.E.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:x,disabled:o,className:(0,y.cn)("relative px-8 py-4 rounded-2xl font-bold text-lg transition-all duration-300 flex items-center gap-3",s?"bg-red-500/20 text-red-400 border border-red-500/50 hover:bg-red-500/30":"bg-gradient-to-r from-accent-burgundy to-accent-gold text-white shadow-neon-burgundy hover:shadow-neon-gold",o&&"opacity-70 cursor-wait"),children:[(0,a.jsx)(N.M,{mode:"wait",children:o?(0,a.jsx)(l.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"w-6 h-6 border-2 border-white/30 border-t-white rounded-full animate-spin"},"loading"):s?(0,a.jsx)(l.E.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},children:(0,a.jsx)(ec.Z,{size:24,fill:"currentColor"})},"stop"):(0,a.jsx)(l.E.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},children:(0,a.jsx)(el.Z,{size:24})},"start")}),(0,a.jsx)("span",{children:o?"Connecting...":s?"End Stream":"Go Live"})]}),r&&r.platforms.length>0&&(0,a.jsx)("div",{className:"flex items-center gap-2",children:r.platforms.map(e=>(0,a.jsxs)("div",{className:(0,y.cn)("px-3 py-2 rounded-lg text-xs font-medium flex items-center gap-2","streaming"===e.status?"bg-green-500/20 text-green-400":"connected"===e.status?"bg-yellow-500/20 text-yellow-400":"bg-gray-500/20 text-gray-400"),children:[(0,a.jsx)("span",{className:(0,y.cn)("w-2 h-2 rounded-full","streaming"===e.status?"bg-green-400 animate-pulse":"bg-gray-400")}),(0,a.jsx)("span",{className:"capitalize",children:e.name})]},e.id))})]})}var em=s(4972),eu=s(2820),eh=s(875),eg=s(401),ep=s(5863),eb=s(4438),ej=s(1837),ef=s(257);function ey(e){let{streamId:t,className:s}=e,[n,c]=(0,i.useState)("speak"),{aiDirectorEnabled:r,setAiDirectorEnabled:o}=(0,v.D)(),[d,m]=(0,i.useState)(""),[h,g]=(0,i.useState)(!1),[p,b]=(0,i.useState)(!1),[j,f]=(0,i.useState)([]),[w,S]=(0,i.useState)(null),[k,C]=(0,i.useState)(!1),[Z,I]=(0,i.useState)([]),[A,E]=(0,i.useState)(null),[T,L]=(0,i.useState)(!1),[D,_]=(0,i.useState)("elevenlabs"),[P,U]=(0,i.useState)(""),[R,F]=(0,i.useState)("professional"),[B,M]=(0,i.useState)(""),[O,V]=(0,i.useState)(""),[H,G]=(0,i.useState)(""),J=(0,v.D)(e=>e.avatarSessionId);async function W(){let{data:e}=await ej.b1.list();e&&(f(e),e.length>0&&S(e[0]))}async function K(){let{data:e}=await ej.b1.listVoices();e&&(I([...e.heygen,...e.elevenlabs]),e.elevenlabs.length>0&&E(e.elevenlabs[0]))}async function q(){if(d.trim()&&w){b(!0);try{let{data:e}=await ej.b1.speak({sessionId:J||"demo-session",streamId:t||"demo-stream",text:d,voiceId:null==A?void 0:A.voice_id,useElevenLabs:"elevenlabs"===D});(null==e?void 0:e.duration)?setTimeout(()=>{b(!1),m("")},e.duration):b(!1)}catch(e){b(!1)}}}async function Q(){if(P.trim()){g(!0);try{let{data:e}=await ej.no.generateScript(P,R,60);(null==e?void 0:e.script)&&M(e.script)}catch(e){console.error("Failed to generate script:",e)}finally{g(!1)}}}async function Y(){if(O.trim()){g(!0);try{let{data:e}=await ej.no.getChatResponse(O,"AI Avatar Livestream Demo",[]);(null==e?void 0:e.response)&&G(e.response)}catch(e){console.error("Failed to get response:",e)}finally{g(!1)}}}return(0,i.useEffect)(()=>{W(),K()},[]),(0,a.jsxs)("div",{className:(0,y.cn)("glass rounded-2xl overflow-hidden",s),children:[(0,a.jsx)("div",{className:"p-4 border-b border-white/10",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-accent-burgundy/30 to-accent-gold/30 flex items-center justify-center",children:(0,a.jsx)(em.Z,{size:20,className:"text-accent-gold"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold",children:"AI Control Center"}),(0,a.jsx)("p",{className:"text-xs text-gray-400",children:"Avatar speech, scripts, & chat responses"})]})]})}),(0,a.jsx)("div",{className:"flex border-b border-white/10",children:[{id:"speak",icon:(0,a.jsx)(x.Z,{size:16}),label:"Speak"},{id:"script",icon:(0,a.jsx)(eu.Z,{size:16}),label:"Script"},{id:"respond",icon:(0,a.jsx)(u.Z,{size:16}),label:"Respond"},{id:"director",icon:(0,a.jsx)(z.Z,{size:16}),label:"Director"}].map(e=>(0,a.jsxs)("button",{onClick:()=>c(e.id),className:(0,y.cn)("flex-1 py-3 px-4 flex items-center justify-center gap-2 transition-all duration-200",n===e.id?"text-white bg-white/10":"text-gray-400 hover:text-white hover:bg-white/5"),children:[e.icon,(0,a.jsx)("span",{className:"text-sm font-medium hidden sm:inline",children:e.label})]},e.id))}),(0,a.jsxs)("div",{className:"p-4 space-y-4",children:["speak"===n&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("label",{className:"block text-xs text-gray-400 mb-1.5",children:"Avatar"}),(0,a.jsxs)("button",{onClick:()=>C(!k),className:"w-full px-3 py-2.5 rounded-xl bg-surface-300 border border-white/10 text-left flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm truncate",children:(null==w?void 0:w.avatar_name)||"Select Avatar"}),(0,a.jsx)(eh.Z,{size:16,className:"text-gray-400"})]}),(0,a.jsx)(N.M,{children:k&&(0,a.jsx)(l.E.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"absolute top-full left-0 right-0 mt-1 bg-surface-200 border border-white/10 rounded-xl overflow-hidden z-50",children:j.map(e=>(0,a.jsxs)("button",{onClick:()=>{S(e),C(!1)},className:(0,y.cn)("w-full px-3 py-2 text-left text-sm flex items-center justify-between hover:bg-white/10",(null==w?void 0:w.avatar_id)===e.avatar_id&&"bg-white/5"),children:[(0,a.jsx)("span",{children:e.avatar_name}),(null==w?void 0:w.avatar_id)===e.avatar_id&&(0,a.jsx)(eg.Z,{size:14,className:"text-accent-gold"})]},e.avatar_id))})})]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("label",{className:"block text-xs text-gray-400 mb-1.5",children:"Voice"}),(0,a.jsxs)("button",{onClick:()=>L(!T),className:"w-full px-3 py-2.5 rounded-xl bg-surface-300 border border-white/10 text-left flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm truncate",children:(null==A?void 0:A.name)||"Select Voice"}),(0,a.jsx)(eh.Z,{size:16,className:"text-gray-400"})]}),(0,a.jsx)(N.M,{children:T&&(0,a.jsx)(l.E.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"absolute top-full left-0 right-0 mt-1 bg-surface-200 border border-white/10 rounded-xl overflow-hidden z-50 max-h-48 overflow-y-auto",children:Z.map(e=>(0,a.jsxs)("button",{onClick:()=>{E(e),L(!1)},className:(0,y.cn)("w-full px-3 py-2 text-left text-sm flex items-center justify-between hover:bg-white/10",(null==A?void 0:A.voice_id)===e.voice_id&&"bg-white/5"),children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{children:e.name}),(0,a.jsx)("span",{className:"text-xs text-gray-400 ml-2",children:e.gender})]}),(null==A?void 0:A.voice_id)===e.voice_id&&(0,a.jsx)(eg.Z,{size:14,className:"text-accent-gold"})]},e.voice_id))})})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-xs text-gray-400",children:"Provider:"}),(0,a.jsxs)("div",{className:"flex rounded-lg bg-surface-400 p-0.5",children:[(0,a.jsx)("button",{onClick:()=>_("elevenlabs"),className:(0,y.cn)("px-3 py-1 text-xs rounded-md transition-colors","elevenlabs"===D?"bg-accent-burgundy text-white":"text-gray-400 hover:text-white"),children:"ElevenLabs"}),(0,a.jsx)("button",{onClick:()=>_("heygen"),className:(0,y.cn)("px-3 py-1 text-xs rounded-md transition-colors","heygen"===D?"bg-accent-gold text-white":"text-gray-400 hover:text-white"),children:"HeyGen"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs text-gray-400 mb-1.5",children:"Text to Speak"}),(0,a.jsx)("textarea",{value:d,onChange:e=>m(e.target.value),placeholder:"Enter text for the avatar to speak...",className:"input-field min-h-[100px] resize-none",disabled:p})]}),(0,a.jsx)("button",{onClick:q,disabled:!d.trim()||!w||p,className:(0,y.cn)("w-full py-3 rounded-xl font-semibold transition-all duration-300 flex items-center justify-center gap-2",d.trim()&&w&&!p?"bg-gradient-to-r from-accent-burgundy to-accent-gold text-white hover:shadow-neon-gold":"bg-gray-600 text-gray-400 cursor-not-allowed"),children:p?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ep.Z,{size:18,className:"animate-spin"}),"Speaking..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(X.Z,{size:18}),"Speak Now"]})})]}),"script"===n&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs text-gray-400 mb-1.5",children:"Topic"}),(0,a.jsx)("input",{type:"text",value:P,onChange:e=>U(e.target.value),placeholder:"What should the avatar talk about?",className:"input-field"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs text-gray-400 mb-1.5",children:"Style"}),(0,a.jsxs)("select",{value:R,onChange:e=>F(e.target.value),className:"input-field",title:"Script Style",children:[(0,a.jsx)("option",{value:"professional",children:"Professional"}),(0,a.jsx)("option",{value:"casual",children:"Casual & Friendly"}),(0,a.jsx)("option",{value:"educational",children:"Educational"}),(0,a.jsx)("option",{value:"entertaining",children:"Entertaining"}),(0,a.jsx)("option",{value:"inspiring",children:"Inspiring"})]})]}),(0,a.jsx)("button",{onClick:Q,disabled:!P.trim()||h,className:(0,y.cn)("w-full py-3 rounded-xl font-semibold transition-all duration-300 flex items-center justify-center gap-2",P.trim()&&!h?"bg-accent-burgundy text-white hover:bg-accent-burgundy/80":"bg-gray-600 text-gray-400 cursor-not-allowed"),children:h?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ep.Z,{size:18,className:"animate-spin"}),"Generating..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(eu.Z,{size:18}),"Generate Script"]})}),B&&(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)("label",{className:"block text-xs text-gray-400 mb-1.5",children:"Generated Script"}),(0,a.jsx)("div",{className:"p-4 rounded-xl bg-surface-400 text-sm whitespace-pre-wrap",children:B}),(0,a.jsx)("button",{onClick:function(){m(B),c("speak")},className:"mt-2 w-full py-2 rounded-lg bg-white/10 text-sm hover:bg-white/20 transition-colors",children:"Use This Script"})]})]}),"respond"===n&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs text-gray-400 mb-1.5",children:"Viewer Question"}),(0,a.jsx)("input",{type:"text",value:O,onChange:e=>V(e.target.value),placeholder:"Enter a viewer's question...",className:"input-field"})]}),(0,a.jsx)("button",{onClick:Y,disabled:!O.trim()||h,className:(0,y.cn)("w-full py-3 rounded-xl font-semibold transition-all duration-300 flex items-center justify-center gap-2",O.trim()&&!h?"bg-accent-gold text-white hover:bg-accent-gold/80":"bg-gray-600 text-gray-400 cursor-not-allowed"),children:h?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ep.Z,{size:18,className:"animate-spin"}),"Thinking..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(em.Z,{size:18}),"Generate Response"]})}),H&&(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)("label",{className:"block text-xs text-gray-400 mb-1.5",children:"AI Response"}),(0,a.jsx)("div",{className:"p-4 rounded-xl bg-surface-400 text-sm",children:H}),(0,a.jsx)("button",{onClick:function(){m(H),c("speak")},className:"mt-2 w-full py-2 rounded-lg bg-white/10 text-sm hover:bg-white/20 transition-colors",children:"Speak This Response"})]})]}),"director"===n&&(0,a.jsxs)("div",{className:"space-y-6 py-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 rounded-2xl bg-surface-400 border border-white/5",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("h4",{className:"font-semibold text-white flex items-center gap-2",children:[(0,a.jsx)(z.Z,{size:16,className:"text-accent-gold"}),"Auto-Director Mode"]}),(0,a.jsx)("p",{className:"text-xs text-gray-400 max-w-[200px]",children:"AI will automatically switch scenes based on chat engagement and stream context."})]}),(0,a.jsx)("button",{onClick:async()=>{let e=!r;if(o(e),t)try{await fetch("".concat(ef.env.NEXT_PUBLIC_API_URL||"http://localhost:3001","/api/streams/").concat(t,"/config"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({aiDirectorEnabled:e})})}catch(e){console.error("Failed to sync director state:",e)}},title:r?"Disable AI Director":"Enable AI Director",className:(0,y.cn)("relative w-12 h-6 rounded-full transition-colors duration-300",r?"bg-accent-gold":"bg-gray-700"),children:(0,a.jsx)(l.E.div,{animate:{x:r?26:4},className:"absolute top-1 w-4 h-4 rounded-full bg-white shadow-sm"})})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h4",{className:"text-xs font-semibold text-gray-400 uppercase tracking-wider",children:"How it works"}),(0,a.jsx)("div",{className:"grid gap-3",children:[{title:"Engagement Analysis",desc:"Monitors chat velocity and sentiment."},{title:"Contextual Switching",desc:"Detects topics and switches to relevant layouts."},{title:"Smart Cooldown",desc:"Prevents rapid switches for a professional feel."}].map((e,t)=>(0,a.jsxs)("div",{className:"flex gap-3 p-3 rounded-xl bg-white/5",children:[(0,a.jsx)("div",{className:"w-6 h-6 rounded-full bg-accent-gold/10 flex items-center justify-center text-accent-gold text-xs font-bold",children:t+1}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-200",children:e.title}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:e.desc})]})]},t))})]}),(0,a.jsxs)("div",{className:"space-y-4 pt-4 border-t border-white/5",children:[(0,a.jsx)("h4",{className:"text-xs font-semibold text-gray-400 uppercase tracking-wider",children:"Simulate Lab"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsx)("button",{onClick:async()=>{try{await fetch("".concat(ef.env.NEXT_PUBLIC_API_URL||"http://localhost:3001","/api/test/director/event"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"donation",data:{amount:100,user:"BigSpender"},streamId:t})}),eb.A.success("Simulation: $100 Donation Event Sent")}catch(e){eb.A.error("Simulation failed")}},className:"px-3 py-2 rounded-lg bg-green-500/10 border border-green-500/20 text-green-400 text-xs font-bold hover:bg-green-500/20 transition-all",children:"Simulate $100 Tip"}),(0,a.jsx)("button",{onClick:async()=>{try{await fetch("".concat(ef.env.NEXT_PUBLIC_API_URL||"http://localhost:3001","/api/test/director/event"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"chat",data:{message:"Show us the code!"},streamId:t})}),eb.A.success("Simulation: Contextual Chat Sent")}catch(e){eb.A.error("Simulation failed")}},className:"px-3 py-2 rounded-lg bg-blue-500/10 border border-blue-500/20 text-blue-400 text-xs font-bold hover:bg-blue-500/20 transition-all",children:"Force Scene Analysis"})]})]}),(0,a.jsxs)("div",{className:"p-4 rounded-xl bg-accent-burgundy/10 border border-accent-burgundy/20 text-xs text-accent-burgundy",children:[(0,a.jsx)("strong",{children:"Note:"})," Auto-Director requires an active stream to function correctly."]})]})]})]})}var ev=s(5749),eN=s(605),ew=s(9376),eS=s(525),ek=s(8997),ez=s(8919),eC=s(221),eZ=s(6221),eI=s(7168),eA=s(3085),eE=s(257);function eT(e){let{streamId:t,className:s}=e,{analytics:n,setAnalytics:c,stream:r,isStreaming:x,streamDuration:m,aiInsights:g,directorLogs:p}=(0,v.D)(),[b,f]=(0,i.useState)(!1),[N,w]=(0,i.useState)(0),S=(0,i.useCallback)(async()=>{if(t)try{f(!0);let e=await fetch("".concat(eE.env.NEXT_PUBLIC_API_URL,"/api/analytics/").concat(t)),s=await e.json();w((null==n?void 0:n.totalViewers)||0),c({totalViewers:s.totalViewers||0,peakViewers:s.peakViewers||0,averageWatchTime:s.averageWatchTime||0,chatMessages:s.chatMessages||0,reactions:s.reactions||0,shares:s.shares||0,newFollowers:s.newFollowers||0,platformBreakdown:s.platformBreakdown||[],viewerTimeline:s.viewerTimeline||[]})}catch(e){console.error("Failed to fetch analytics:",e)}finally{f(!1)}},[t,c,null==n?void 0:n.totalViewers]);(0,i.useEffect)(()=>{if(x&&t){S();let e=setInterval(S,1e4);return()=>clearInterval(e)}},[x,t,S]);let k=((null==n?void 0:n.totalViewers)||0)-N,C=N>0?(k/N*100).toFixed(1):"0",Z=e=>{switch(e.toLowerCase()){case"youtube":return(0,a.jsx)(M.Z,{size:16,className:"text-red-500"});case"twitch":return(0,a.jsx)(O.Z,{size:16,className:"text-purple-500"});case"facebook":return(0,a.jsx)(V.Z,{size:16,className:"text-blue-500"});default:return(0,a.jsx)(H.Z,{size:16,className:"text-gray-400"})}},I=[{label:"Live Viewers",value:(null==r?void 0:r.viewerCount)||(null==n?void 0:n.totalViewers)||0,icon:(0,a.jsx)(j.Z,{size:18}),color:"gold",trend:0!==k?{value:"".concat(k>0?"+":"").concat(C,"%"),positive:k>0}:null},{label:"Peak Viewers",value:(null==n?void 0:n.peakViewers)||0,icon:(0,a.jsx)(eS.Z,{size:18}),color:"burgundy"},{label:"Chat Messages",value:(null==n?void 0:n.chatMessages)||0,icon:(0,a.jsx)(u.Z,{size:18}),color:"gold"},{label:"Reactions",value:(null==n?void 0:n.reactions)||0,icon:(0,a.jsx)(ek.Z,{size:18}),color:"burgundy"},{label:"Shares",value:(null==n?void 0:n.shares)||0,icon:(0,a.jsx)(ez.Z,{size:18}),color:"green"},{label:"New Followers",value:(null==n?void 0:n.newFollowers)||0,icon:(0,a.jsx)(h.Z,{size:18}),color:"blue"},{label:"AI Latency",value:"42ms",icon:(0,a.jsx)(eC.Z,{size:18}),color:"green"}];return(0,a.jsxs)("div",{className:(0,y.cn)("glass rounded-2xl p-5",s),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-5",children:[(0,a.jsxs)("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[(0,a.jsx)(eZ.Z,{size:20,className:"text-accent-gold"}),"Live Analytics"]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[x&&(0,a.jsxs)("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-lg bg-red-500/20",children:[(0,a.jsx)("div",{className:"w-2 h-2 rounded-full bg-red-500 animate-pulse"}),(0,a.jsx)("span",{className:"text-xs font-medium text-red-400",children:(0,y.LU)(m)})]}),(0,a.jsx)("button",{onClick:S,disabled:b,className:(0,y.cn)("p-2 rounded-lg bg-white/5 hover:bg-white/10 transition-colors",b&&"animate-spin"),title:"Refresh Analytics",children:(0,a.jsx)(eI.Z,{size:14})})]})]}),(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 xl:grid-cols-7 gap-3 mb-5",children:I.map((e,t)=>(0,a.jsxs)(l.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.05*t},className:"p-3 rounded-xl bg-white/5 hover:bg-white/8 transition-colors",children:[(0,a.jsx)("div",{className:(0,y.cn)("w-8 h-8 rounded-lg mb-2 flex items-center justify-center","gold"===e.color&&"bg-accent-gold/20 text-accent-gold","burgundy"===e.color&&"bg-accent-burgundy/20 text-accent-burgundy","green"===e.color&&"bg-green-500/20 text-green-400","blue"===e.color&&"bg-blue-500/20 text-blue-400"),children:e.icon}),(0,a.jsxs)("div",{className:"flex items-end gap-1.5",children:[(0,a.jsx)("span",{className:"text-xl font-bold",children:"number"==typeof e.value?(0,y.uf)(e.value):e.value}),e.trend&&(0,a.jsxs)("span",{className:(0,y.cn)("text-xs flex items-center gap-0.5 mb-0.5",e.trend.positive?"text-green-400":"text-red-400"),children:[e.trend.positive?(0,a.jsx)(eS.Z,{size:10}):(0,a.jsx)(eA.Z,{size:10}),e.trend.value]})]}),(0,a.jsx)("span",{className:"text-[10px] text-gray-500",children:e.label})]},e.label))}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"p-4 rounded-xl bg-white/5",children:[(0,a.jsxs)("h3",{className:"text-sm font-medium text-gray-300 mb-3 flex items-center gap-2",children:[(0,a.jsx)(d.Z,{size:14}),"Platform Breakdown"]}),(null==n?void 0:n.platformBreakdown)&&n.platformBreakdown.length>0?(0,a.jsx)("div",{className:"space-y-3",children:n.platformBreakdown.map(e=>(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[Z(e.platform),(0,a.jsx)("span",{className:"text-sm text-gray-400 w-16 capitalize",children:e.platform}),(0,a.jsx)("div",{className:"flex-1 h-2 bg-white/10 rounded-full overflow-hidden",children:(0,a.jsx)(l.E.div,{initial:{width:0},animate:{width:"".concat(e.percentage,"%")},transition:{duration:.8,ease:"easeOut"},className:(0,y.cn)("h-full rounded-full","youtube"===e.platform&&"bg-red-500","twitch"===e.platform&&"bg-purple-500","facebook"===e.platform&&"bg-blue-500",!["youtube","twitch","facebook"].includes(e.platform)&&"bg-gray-500")})}),(0,a.jsx)("span",{className:"text-sm font-medium w-12 text-right",children:(0,y.uf)(e.viewers)})]},e.platform))}):(0,a.jsx)("div",{className:"text-center py-4 text-gray-500 text-sm",children:"No platform data yet"})]}),(0,a.jsxs)("div",{className:"p-4 rounded-xl bg-white/5",children:[(0,a.jsxs)("h3",{className:"text-sm font-medium text-gray-300 mb-3 flex items-center gap-2",children:[(0,a.jsx)(o.Z,{size:14}),"Stream Metrics"]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-gray-400",children:"Avg. Watch Time"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:(null==n?void 0:n.averageWatchTime)?(0,y.LU)(n.averageWatchTime):"--:--"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-gray-400",children:"Stream Duration"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:(0,y.LU)(m)})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-gray-400",children:"Engagement Rate"}),(0,a.jsxs)("span",{className:"text-sm font-medium",children:[n&&n.totalViewers>0?((n.chatMessages+n.reactions)/n.totalViewers*100).toFixed(1):"0","%"]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-gray-400",children:"Chat Rate"}),(0,a.jsxs)("span",{className:"text-sm font-medium",children:[m>0?Math.round(((null==n?void 0:n.chatMessages)||0)/(m/60)):0,"/min"]})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 mt-4",children:[(0,a.jsxs)("div",{className:"p-4 rounded-xl bg-accent-gold/5 border border-accent-gold/10",children:[(0,a.jsxs)("h3",{className:"text-sm font-medium text-accent-gold mb-3 flex items-center gap-2",children:[(0,a.jsx)(z.Z,{size:14}),"AI Stream Insights"]}),(0,a.jsx)("div",{className:"text-sm text-gray-300 leading-relaxed italic",children:g||(0,a.jsx)("span",{className:"text-gray-500",children:"AI is currently analyzing your stream data. Insights will appear here every 2 minutes."})})]}),(0,a.jsxs)("div",{className:"p-4 rounded-xl bg-white/5 border border-white/10",children:[(0,a.jsxs)("h3",{className:"text-sm font-medium text-gray-300 mb-3 flex items-center gap-2",children:[(0,a.jsx)(eC.Z,{size:14}),"Director Automation Log"]}),(0,a.jsx)("div",{className:"space-y-2 max-h-[120px] overflow-y-auto custom-scrollbar pr-2",children:p.length>0?p.map(e=>(0,a.jsxs)("div",{className:"text-[11px] flex gap-2",children:[(0,a.jsx)("span",{className:"text-gray-500 whitespace-nowrap",children:new Date(e.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"})}),(0,a.jsxs)("span",{className:(0,y.cn)("font-medium","success"===e.type&&"text-green-400","warning"===e.type&&"text-amber-400","info"===e.type&&"text-blue-400"),children:["[",e.type.toUpperCase(),"]"]}),(0,a.jsx)("span",{className:"text-gray-400",children:e.message})]},e.id)):(0,a.jsx)("div",{className:"text-center py-4 text-gray-500 text-xs italic",children:"No automation events logged yet."})})]})]})]})]})}var eL=s(257);function eD(){let{aiDirectorEnabled:e,activeScene:t,scenes:s,setActiveScene:a,chatMessages:l,isStreaming:n,addDirectorLog:c,setDirectorLogs:r,setAiInsights:o,analytics:d,stream:x}=(0,v.D)(),m=null==x?void 0:x.id,{switchScene:u}=(0,ev.s)(m),h=(0,i.useRef)(0);return(0,i.useEffect)(()=>{m&&fetch("".concat(eL.env.NEXT_PUBLIC_API_URL||"http://localhost:3001","/api/streams/").concat(m,"/director-events")).then(e=>e.json()).then(e=>{Array.isArray(e)&&r(e.map(e=>({id:e.id,timestamp:new Date(e.timestamp),message:e.message,type:e.type})))}).catch(console.error)},[m,r]),(0,i.useEffect)(()=>{if(!e||!n)return;let a=async()=>{if(null==d?void 0:d.viewerTimeline)try{let e=await fetch("".concat(eL.env.NEXT_PUBLIC_API_URL||"http://localhost:3001","/api/ai/analyze-engagement"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({streamId:m,viewerCount:d.viewerTimeline.map(e=>e.count),chatActivity:[l.length],sceneChanges:[]})});if(e.ok){let t=await e.json();o(t.insights)}}catch(e){console.error("Failed to fetch AI insights:",e)}},i=setInterval(async()=>{if(!(Date.now()-h.current<6e4))try{let e=await fetch("".concat(eL.env.NEXT_PUBLIC_API_URL||"http://localhost:3001","/api/ai/suggest-scene"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({currentScene:(null==t?void 0:t.name)||"none",chatHistory:l.slice(-20).map(e=>"".concat(e.username,": ").concat(e.message)),availableScenes:s.map(e=>e.name)})});if(!e.ok)return;let a=await e.json();if(a&&a.confidence>.7){let e=s.find(e=>e.name===a.name);e&&e.id!==(null==t?void 0:t.id)&&(eb.A.info("AI Director: Switching to ".concat(e.name),{description:a.description}),c({message:"Auto-switched to ".concat(e.name,": ").concat(a.description),type:"success"}),m&&fetch("".concat(eL.env.NEXT_PUBLIC_API_URL||"http://localhost:3001","/api/streams/").concat(m,"/director-events"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"success",message:"Auto-switched to ".concat(e.name,": ").concat(a.description),metadata:a})}).catch(console.error),u(e.id),h.current=Date.now())}}catch(e){console.error("AI Director failed to get suggestion:",e)}},3e4),r=setInterval(a,12e4);return()=>{clearInterval(i),clearInterval(r)}},[e,n,t,s,l,a,c,o,d,m,u]),null}let e_={id:"avatar-1",name:"Alex - Professional Host",provider:"heygen",thumbnailUrl:"",voiceId:"voice-1",status:"idle",settings:{language:"en-US",emotion:"neutral",speed:1,pitch:1,volume:1}};function eP(){let{data:e,status:t}=(0,eN.useSession)(),s=(0,ew.useRouter)(),[n,c]=(0,i.useState)(""),{setScenes:r,setActiveScene:o,setStream:d,setAvatars:x,setActiveAvatar:m,setAnalytics:u,setAiDirectorEnabled:h,setAiInsights:g,stream:p,isStreaming:b}=(0,v.D)(),{socket:j}=(0,ev.s)(n||void 0);return((0,i.useEffect)(()=>{"unauthenticated"===t&&s.push("/auth/signin")},[t,s]),(0,i.useEffect)(()=>{var s;"authenticated"===t&&(null==e?void 0:null===(s=e.user)||void 0===s?void 0:s.id)&&(async()=>{try{let t;let s=await ej.Iu.getByUser(e.user.id);if(s.data&&s.data.length>0)t=s.data[0];else{let s=await ej.Iu.create({title:"".concat(e.user.name||"User","'s Studio"),description:"AI-Powered Livestream Session",platforms:[{name:"youtube",streamKey:"demo-key"},{name:"twitch",streamKey:"demo-key"},{name:"facebook",streamKey:"demo-key"}],quality:"1080p30"});if(s.data)t=s.data.stream;else throw Error("Failed to create stream")}c(t.id),d(t),void 0!==t.aiDirectorEnabled&&h(t.aiDirectorEnabled),t.latestAiInsights&&g(t.latestAiInsights);let a=await ej.Ar.list(t.id);if(a.data){r(a.data);let e=a.data.find(e=>e.isActive)||a.data[0];e&&o(e)}x([e_]),m(e_)}catch(e){console.error("Error initializing studio:",e)}})()},[t,e,d,r,o,x,m]),"loading"===t)?(0,a.jsx)("div",{className:"h-screen w-full flex items-center justify-center bg-surface-500",children:(0,a.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,a.jsx)("div",{className:"w-12 h-12 border-4 border-accent-gold border-t-transparent rounded-full animate-spin"}),(0,a.jsx)("p",{className:"text-gray-400 font-medium",children:"Loading Studio..."})]})}):e?(0,a.jsxs)("div",{className:"h-screen flex flex-col bg-surface-500 overflow-hidden",children:[(0,a.jsx)(et,{}),(0,a.jsxs)("div",{className:"flex-1 flex overflow-hidden",children:[(0,a.jsx)(ea,{}),(0,a.jsx)("main",{className:"flex-1 flex flex-col overflow-y-auto custom-scrollbar",children:(0,a.jsxs)("div",{className:"p-4 lg:p-6 space-y-4 lg:space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-4 lg:gap-6",children:[(0,a.jsxs)("div",{className:"xl:col-span-2 space-y-4",children:[(0,a.jsxs)(l.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"aspect-video glass rounded-2xl overflow-hidden relative",children:[(0,a.jsx)(ed,{className:"h-full w-full"}),(0,a.jsx)("div",{className:"absolute bottom-4 left-4 right-4 pointer-events-none",children:(0,a.jsx)(ee.iu,{streamId:n,className:"max-w-[400px] pointer-events-auto"})})]}),(0,a.jsx)(ex,{})]}),(0,a.jsx)(l.E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"h-full",children:(0,a.jsx)(ey,{streamId:n})})]}),(0,a.jsx)(l.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:(0,a.jsx)(eT,{streamId:n})})]})})]}),(0,a.jsx)(eD,{})]}):null}}},function(e){e.O(0,[230,605,941,24,438,897,534,971,117,744],function(){return e(e.s=7945)}),_N_E=e.O()}]);